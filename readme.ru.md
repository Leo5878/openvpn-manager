# OpenVPN API Wrapper

Лёгкий обёртка для OpenVPN API, которая работает через Telnet.
Библиотека не имеет зависимостей – используется только стандартный функционал Node.js.
Методы можно заменить на аналоги для других рантаймов (Deno, Bun).

Проект написан на TypeScript, поэтому вы получаете статическую типизацию и автодополнение в вашей IDE.

[Документация на английском](/readme.md)


## Использование

```ts
// Импортируем хелпер для типизации
import { CustomEventType } from "../openvpn-api/event-responses.types";

// Создаём опциональный эмиттер
const event = new EventEmitter<CustomEventType>();

// Инициализируем подключение к OpenVPN API
const api = new OpenvpnApi(
  {
    id: "1",            // Идентификатор сервера (любая строка)
    host: "127.0.0.1",  // Хост интерфейса управления OpenVPN
    port: 7505,         // Порт интерфейса управления OpenVPN
    timeout: 5000,      // Таймаут подключения в ms (по умолчанию 5000)
  },
  {
    event,              // (опционально) передача собственного EventEmitter (теряется типизация)
    logger,             // (опционально) кастомный логгер (по умолчанию console)
    statusInterval,     // (опционально) период обновления статуса
  }
);
```

Подключение к серверу
```ts
await api.connect();
```


## События

Чтобы подписаться на события сервера, используйте переданный или собственный `EventEmitter`:

```ts
event.on("client:connection", (data) => {
  console.log(data);
});
```

| Событие             | Тип                | Описание                                        |
| ------------------- | ------------------ | ----------------------------------------------- |
| `client:connection` | `ClientConnection` | Событие о подключении клиента                   |
| `client:list`       | `ClientList`       | Список подключённых клиентов                    |
| `byte:count`        | `ByteCount`        | Информация о трафике клиента                    |

## Status

Метод **status** возвращает информацию о подключённых клиентах:

* CN (имя клиента)
* Реальный адрес (IP:порт)
* Виртуальный IP клиента
* Объём входящего и исходящего трафика
* Дата и время подключения

Подробнее см. в официальной документации:
[OpenVPN Management Interface Documentation](https://openvpn.net/community-resources/management-interface/)
