# OpenVPN Manager Wrapper

OpenVPN Manager Wrapper ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è TypeScript-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è —É–¥–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ 
OpenVPN Management Interface. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É, —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –∏–º–µ–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª Node.js.
–ú–µ—Ç–æ–¥—ã –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤ (Deno, Bun).\
–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ TypeScript, –ø–æ—ç—Ç–æ–º—É –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é –∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –≤–∞—à–µ–π IDE.

–î–ª—è —É–¥–æ–±–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å NestJS –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ë—Ä—Ç–∫—É:\
üëâ [openvpn-manager-nestjs](https://github.com/Leo5878/openvpn-manager-nestjs)

[–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º](/README.md)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
### npm
```bash
npm install @ad0nis/openvpn-manager
```

### yarn
```bash
yarn add @ad0nis/openvpn-manager
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –°–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ OpenVPN —Å–µ—Ä–≤–µ—Ä

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–°–æ–∑–¥–∞–π—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä `OpenvpnManager` –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:\
–û —Ç–æ–º –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å OpenVPN Manager —á–∏—Ç–∞–π—Ç–µ [–∑–¥–µ—Å—å](./docs/Openvpn-manager.md) –∏–ª–∏ –≤ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ OpenVPN](https://openvpn.net/community-docs/community-articles/openvpn-2-6-manual.html#management-interface-options-177179)

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```ts
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenVPN API
const api = new OpenvpnManager(
  {
    id: "srv1",         // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ (–ª—é–±–∞—è —Å—Ç—Ä–æ–∫–∞)
    host: "127.0.0.1",  // –ê–¥—Ä–µ—Å –¥–æ OpenVPN manager
    port: 7505,         // –ü–æ—Ä—Ç –¥–æ OpenVPN manager
    timeout: 5000,      // –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ ms (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5000)
  },
);

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
await api.connect();
```
–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å OpenVPN —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:
```ts
// –ü–æ–¥–∫–ª—é—á–∏–≤—à–µ—Å—è –∫–ª–∏–µ–Ω—Ç
api.on("client:connection", (client: ConnectionClient) => {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–∏–≤—à–µ–≥–æ—Å—è –∫–ª–∏–µ–Ω—Ç–∞
})
    
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
api.once("client:list", (clients: Cl) => {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ú–µ—Ç–æ–¥ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑
})
```
–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏–≤–µ–¥—ë–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ [–°–æ–±—ã—Ç–∏—è](#—Å–æ–±—ã—Ç–∏—è)

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `OpenvpnManager`:

- `event` ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π EventEmitter –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —ç–º–∏—Ç—Ç–µ—Ä).
- `logger` ‚Äî –ª–æ–≥–≥–µ—Ä –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `console`).
- `reconnect` ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é always, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è. –ó–Ω–∞—á–µ–Ω–∏–µ never –æ—Ç–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ. –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `always`, `never`.

```ts
// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ö–µ–ª–ø–µ—Ä –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
import { CustomEventType } from "openvpn-manager/event-responses.types";

// –°–æ–∑–¥–∞—ë–º —ç–º–∏—Ç—Ç–µ—Ä
const emmiter = new EventEmitter<CustomEventType>();

const api = new OpenvpnManager(
  {
    id: "1",
    host: "127.0.0.1",
    port: 7505,
    timeout: 5000,
  },
  {
    event: emmiter, 	// –ö–∞—Å—Ç–æ–º–Ω—ã–π —ç–º–∏—Ç—Ç–µ—Ä —Å–æ–±—ã—Ç–∏–π
    logger: console, 	// –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è console. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä
  }
);
```

## –°–æ–±—ã—Ç–∏—è
–í—Å–µ —Å–æ–±—ã—Ç–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ñ–∞–π–ª–µ —Å [—Ç–∏–ø–∞–º–∏](https://github.com/Leo5878/openvpn-manager/blob/main/src/event-responses.types.ts)

| –°–æ–±—ã—Ç–∏–µ             | –¢–∏–ø                | –û–ø–∏—Å–∞–Ω–∏–µ                                                      |
|---------------------|--------------------|---------------------------------------------------------------|
| `client:connection` | `ClientConnection` | –°–æ–±—ã—Ç–∏–µ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞                                 |
| `client:list`       | `Cl`               | –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤                                  |
| `byte:count`        | `ByteCount`        | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–∞—Ñ–∏–∫–µ –∫–ª–∏–µ–Ω—Ç–∞                                  |
| `client:disconnect` | `ClientDisconnect` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ –∏–∑ CommonName (_–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç—å_)   |
| `socket:error`      | `SocketError`      | –°–æ–±—ã—Ç–∏–µ –æ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏ —Å —Å–æ–∫–µ—Ç–æ–º –≤–æ –≤—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |

### status

–°–æ–±—ã—Ç–∏–µ **client:list** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö:

* CN (–∏–º—è –∫–ª–∏–µ–Ω—Ç–∞)
* –†–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å (IP:–ø–æ—Ä—Ç)
* –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π IP –∫–ª–∏–µ–Ω—Ç–∞
* –û–±—ä—ë–º –≤—Ö–æ–¥—è—â–µ–≥–æ –∏ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
* –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
[OpenVPN Management Interface Documentation](https://openvpn.net/community-resources/management-interface/)

## –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥
–ú–µ—Ç–æ–¥ writeSocket –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Å–æ–∫–µ—Ç OpenVPN Manager.\
–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç —Å—Ç—Ä–æ–∫—É –∫–æ–º–∞–Ω–¥—ã. –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è —Å–∏–º–≤–æ–ª–∞–º–∏ \r\n.

–ü—Ä–∏–º–µ—Ä:
```ts 
this.writeSocket("status 2\r\n"); // <- \r\n - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã
```
–ß—Ç–æ–±—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–≤–µ—Ç, –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ data.\
–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ–Ω–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —É–≤–µ–¥–æ–º–ª—è–µ—Ç
–æ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏—è—Ö, —á—Ç–æ –ø—Ä–∏—Ö–æ–¥—è—Ç –æ—Ç OpenVPN.
> [!NOTE]
> –≠—Ç–æ "—Å—ã—Ä–æ–π" –º–µ—Ç–æ–¥, –æ–Ω –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –ø–∏—à–µ—Ç –≤ —Å–æ–∫–µ—Ç –∫–æ–º–∞–Ω–¥—É.

–ü—Ä–∏–º–µ—Ä:
```ts
api.on("client:connection", (client: ConnectionClient) => {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–∏–≤—à–µ–≥–æ—Å—è –∫–ª–∏–µ–Ω—Ç–∞
})
```
